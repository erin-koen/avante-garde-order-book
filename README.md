# agfin-order-book


> A react app that accesses the public order book of a crypto exchange and builds a visualization based on the data retrieved.

TODO: Fill out this long description.

## Table of Contents

- [Install](#install)
- [Thought Process and Notes](#thought_process)
- [License](#license)

## Install

- Clone this repo to your local machine, and navigate into `order-book` in your terminal
- install the necessary dependencies from package.json using `yarn install` or `npm i`
- To launch the app, use `yarn start` or `npm start` 

- Note - i'm continuing to update this repo so it's worth calling `git pull master` if you didn't *just* clone it.



## Thought Process and Random Notes

Redux - managing a 100 item orderbook (50 orders on each side of the mid seems like it's reasonably useful) isn't hugely complicated for a single component, but for extensibility's sake, Redux makes sense. In the example photo, the order book is displayed graphically and in chart form. Redux simplifies access to the state generated by a single API call, rather than having to manage state flowing through to those disparate components. 

Data comes back from Kraken (SLOWLY) in an array of bids and an array of asks, each of which is ['price', 'amount', timestamp]. Timestamp for my purposes is useless, and amount needs to be cumulative in order to show the total amount that can be bought or sold at that level. Need to do transform the data to reflect that. Best place to do that seems to be in the action creator method, so flow looks like ->
- retrieve data from kraken
- transform as necessary
    - first cut at this was to put data into object shaped like:
    ```
    let prices = {
        bids: {}, 
        asks: {}
      }
    ```
    but I'm not sure that'll be sorted correctly when i access it. TBD.
    - update: changed format of sorted data to reflect what i'll need for React-Vis, an array of objects with color properties according to bid vs ask

- send to reducer to set new state
- update - I'm switching to coinbase pro as their data retrieval is MUCH fast

App component architecture - 

- I'm using Uber's react-vis for the chart visualization. It's fairly simple to implement at a very basic level, and styling looks pretty easy as well. I'll update that when I get to it.

- I'm calling the action creator that updates state with the Coinbase data when the root App mounts. 

- I've connected both the root App and the orderBook component to the Store, so that each has access to global state and I don't need to worry about prop drilling.

- I've added a setTimeout function to the updateBook call, though this is still a bit buggy (I'm currently getting 429s from CB Pro). I updated the timeout to 1 second and added start and stop controls at the top of the page so it shouldn't overwhelm the endpoint while I debug.
    - Update: I'm still getting a 429 from coinbase if I let it run for too long. I think that the calls are taking longer than one second (current to resolve and getting backed up. My first thought about how to remedy this would be to watch for a state change in the reducer and make the next call when that happens. 
    - Update - I've accounted for the error in the action creator and the reducer, and thrown a quick modal in to tell the user what's going on in the event we get an error from the endpoint. 
    - I've also set the timeout to 5 seconds. 

- I want to wrap the chart with order tables displaying the number of traders involved at each level, the amount at each level, and the sum amount of bids or offers between that level and the price. My first cut at this required a bit of manipulation of the data in the action creator. 

- I also wanted to write the table component only once, so instead of connecting the component to the Store, I passed down distinct data from the App component and rendered the table conditionally. 

- There are some display issues at play here - i'm not sure what precision I want the floats for amount at each level to be, so I've set them to integers in the meantime while I think about it. The app in general is not responsive, and I'm not sure I've ever seen an order book that looks good on Mobile widths. There's just too much data. 

## License

MIT Â© 2019 Erin Koen
